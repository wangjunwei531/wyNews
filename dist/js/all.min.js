angular.module("myApp",["ionic","jett.ionic.filter.bar","myApp.tabs","myApp.news","myApp.live","myApp.topic","myApp.me","cftApp.httpFactory","cftApp.slideBox","myApp.newsDetail","myApp.search"]).config([function(){}]).controller("mainController",["$scope",function(){}]),angular.module("myApp.live",["ionic"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("tabs.live",{url:"/live",views:{"tabs-live":{templateUrl:"tabs_live.html",controller:"liveController"}}})}]).controller("liveController",["$scope",function(e){e.live={},e.live.getPage=function(e){var t=angular.element(e.currentTarget).children();angular.forEach(t,function(e,t){angular.element(e).removeAttr("class")}),angular.element(e.target).addClass("active")}}]),angular.module("myApp.me",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("tabs.me",{url:"/me",views:{"tabs-me":{templateUrl:"tabs_me.html",controller:"meController"}}})}]).controller("meController",["$scope",function(e){}]),angular.module("myApp.news",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("tabs.news",{url:"/news",views:{"tabs-news":{templateUrl:"tabs_news.html",controller:"newsController"}}}),t.otherwise("/tabs/news")}]).controller("newsController",["$scope","$state","$stateParams","$ionicSlideBoxDelegate","$ionicViewSwitcher","$ionicTabsDelegate","HttpFactory",function(e,t,o,n,r,l,a){console.log(l);var i=[],s=0,c=0;e.news={showAds:!0,btnShow:!0,text:"排序删除"},e.news.textSame=function(t,o){var n=angular.element(t.currentTarget);o?(n.css({background:"white",color:"red"}),"排序删除"==o?e.news.text="完成":e.news.text="排序删除"):n.css({background:"red",color:"white"})},e.news.getList=function(e){var t=angular.element(e.currentTarget).children();console.log(t);angular.element(document.querySelector(".news .list_view")),angular.element(document.querySelector(".news .list_ctr"));t.addClass("active")},e.news.goSearch=function(){t.go("search"),r.nextDirection("forward")},e.news.nameArray=["头条","娱乐","体育","网易号","本地","视频","财经","科技","汽车","时尚","图片"],e.news.joinDetail=function(e){console.log(e,"item"),t.go("newsDetail",{docId:e.docid}),r.nextDirection("forward")},e.news.dataRefresh=function(){s+=1,c=0;var t="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&prog=LMA1&open=&openpath=&fn="+s+"&passport=&devId=%2BnrKMbpU9ZDPUOhb9gvookO3HKJkIOzrIg%2BI9FhrLRStCu%2B7ZneFbZ30i61TL9kY&offset=0&size=10&version=17.1&spever=false&net=wifi&lat=&lon=&ts=1481113462&sign=DZ76qdaMm6mtlZdb3kRPlwMC9mJyuNtYPbbCOTFGXsd48ErR02zJ6%2FKXOnxX046I&encryption=1&canal=appstore";a.getData(t).then(function(t){console.log(t),t[0].ads?(e.news.showAds=!0,e.news.adsArray=t[0].ads,t.splice(0,1),i=t):(e.news.showAds=!1,i=t),e.news.itemsArray=i,e.$broadcast("scroll.refreshComplete")})},e.news.canSlide=function(e){n.$getByHandle("mainSlideBox").enableSlide(e)},e.news.dataLoading=function(t){if(t){console.log(t.currentTarget);var o=angular.element(t.currentTarget).children();console.log(o)}var n=10*c+1,r="";switch(t){case"头条":r="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&prog=LMA1&open=&openpath=&fn="+s+"&passport=&devId=%2BnrKMbpU9ZDPUOhb9gvookO3HKJkIOzrIg%2BI9FhrLRStCu%2B7ZneFbZ30i61TL9kY&offset="+n+"&size=10&version=17.1&spever=false&net=wifi&lat=&lon=&ts=1480666192&sign=yseE2FNVWcJVjhvP48U1nPHyzZCKpBKh%2BaOhOE2d6GR48ErR02zJ6%2FKXOnxX046I&encryption=1&canal=appstore"}r="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&prog=LMA1&open=&openpath=&fn="+s+"&passport=&devId=%2BnrKMbpU9ZDPUOhb9gvookO3HKJkIOzrIg%2BI9FhrLRStCu%2B7ZneFbZ30i61TL9kY&offset="+n+"&size=10&version=17.1&spever=false&net=wifi&lat=&lon=&ts=1480666192&sign=yseE2FNVWcJVjhvP48U1nPHyzZCKpBKh%2BaOhOE2d6GR48ErR02zJ6%2FKXOnxX046I&encryption=1&canal=appstore",a.getData(r).then(function(t){t[0].ads?(e.news.adsArray=t[0].ads,t.splice(0,1),i=i.concat(t)):i=i.concat(t),console.log(i),e.news.itemsArray=i,e.$broadcast("scroll.infiniteScrollComplete")})},e.news.dataRefresh()}]),angular.module("myApp.newsDetail",["ionic"]).config(["$stateProvider",function(e){e.state("newsDetail",{url:"/newsDetail/:docId",views:{mainPage:{templateUrl:"news_detail.html",controller:"newsDetailController"}}})}]).controller("newsDetailController",["$scope","$ionicViewSwitcher","$stateParams","$sce","$timeout","HttpFactory",function(e,t,o,n,r,l){e.newsDetail={},console.log(o);var a="http://c.m.163.com/nc/article/"+o.docId+"/full.html";l.getData(a).then(function(t){if(console.log(t,"result"),console.log(t,"result"),console.log(t.body),t.img&&t.img.length){for(var o=0;o<t.img.length;o++){var r=t.img[o].pixel.split("*")[0];r>document.body.offsetWidth&&(r=document.body.offsetWidth-20);var l="<img width='"+r+"' src='"+t.img[o].src+"'>";t.body=t.body.replace(t.img[o].ref,l)}e.newsDetail.data=n.trustAsHtml(t.body)}}),e.newsDetail.goBack=function(e){window.history.go(-1),t.nextDirection("back")}}]),angular.module("myApp.search",["ionic"]).config(["$stateProvider",function(e){e.state("search",{url:"/search",views:{mainPage:{templateUrl:"search.html",controller:"searchController"}}})}]).controller("searchController",["$scope","$ionicViewSwitcher",function(e,t){e.search={},e.search.getStyle=function(e){var t=angular.element(e.target).parent();"focus"==e.type?t.addClass("active"):t.removeClass("active")},e.search.goBack=function(){window.history.go(-1),t.nextDirection("back")}}]),angular.module("myApp.tabs",["ionic"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("tabs",{url:"/tabs",views:{mainPage:{templateUrl:"tabs.html",controller:"tabsController"}}})}]).controller("tabsController",["$scope","$ionicModal","$timeout",function(e,t,o){}]),angular.module("myApp.topic",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("tabs.topic",{url:"/topic",views:{"tabs-topic":{templateUrl:"tabs_topic.html",controller:"topicController"}}})}]).controller("topicController",["$scope",function(e){}]),angular.module("cftApp.httpFactory",[]).factory("HttpFactory",["$http","$q",function(e,t){return{getData:function(o,n){if(o){var r=t.defer();return o="http://localhost:3000/?myUrl="+encodeURIComponent(o),n=n?n:"GET",e({url:o,method:n,timeout:2e4}).then(function(e){e=e.data,e=e[Object.keys(e)[0]],r.resolve(e)},function(e){r.reject(e)}),r.promise}}}}]),angular.module("cftApp.slideBox",[]).directive("mgSlideBox",[function(){return{restrict:"E",scope:{sourceArray:"="},template:'<div class="topCarousel"><ion-slide-box delegate-handle="topCarouselSlideBox" on-slide-changed="slideHasChanged($index)" show-pager="true"  ng-if="isShowSlideBox" on-drag="drag($event)"> <ion-slide ng-repeat="ads in sourceArray track by $index" ng-click="goToDetailView($index)"><img ng-src="{{ads.imgsrc}}" class="topCarouselImg"></ion-slide> </ion-slide-box><div class="slideBottomDiv"></div></div>',controller:["$scope","$element","$ionicSlideBoxDelegate","$timeout",function(e,t,o,n){e.goToDetailView=function(e){console.log("进入详情页"+e)};var r=t[0].lastElementChild;e.$watch("sourceArray",function(t,l){t&&t.length&&(l&&l.length&&t.length!=l.length?(e.isShowSlideBox=!1,n(function(){e.isShowSlideBox=!0})):e.isShowSlideBox=!0,o.$getByHandle("topCarouselSlideBox").loop(!0),console.log(r),r.innerText=e.sourceArray[0].title)}),e.slideHasChanged=function(t){r.innerText=e.sourceArray[t].title},o.$getByHandle("mainSlideBox").enableSlide(!1),e.drag=function(e){o.$getByHandle("topCarouselSlideBox").loop(!0),o.$getByHandle("mainSlideBox").enableSlide(!1),e.stopPropagation()}}],replace:!0,link:function(e,t,o){}}}]);